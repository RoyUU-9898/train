<!doctype html>
<html lang="zh-TW" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å°ç£éµè·¯è»Šç«™é…å°éŠæˆ²</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    body { box-sizing: border-box; font-family: 'Noto Sans TC', sans-serif; }

    .station-card { cursor: grab; transition: all 0.2s ease; user-select: none; }
    .station-card:active { cursor: grabbing; }
    .station-card.dragging { opacity: 0.7; transform: scale(1.05) rotate(2deg); }

    @keyframes bounce-in {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }
    .bounce-in { animation: bounce-in 0.5s ease-out; }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
    .float-animation { animation: float 2s ease-in-out infinite; }

    .info-panel { background: linear-gradient(135deg, #fef3c7, #fde68a); }

    .dot-target {
      width: 14px;
      height: 14px;
      border-radius: 9999px;
      background: white;
      border: 2px solid rgba(51,65,85,0.75);
      box-shadow: 0 2px 8px rgba(0,0,0,0.18);
      transform: translate(-50%, -50%);
    }
    .dot-target.matched {
      background: linear-gradient(135deg, #4ade80, #22c55e);
      border: 2px solid rgba(16,185,129,0.95);
      cursor: pointer;
    }

    .label-box {
      border-radius: 16px;
      padding: 10px 10px;
      font-weight: 800;
      font-size: 12px;
      line-height: 1.1;
      box-shadow: 0 6px 18px rgba(0,0,0,0.10);
      background: rgba(255,255,255,0.88);
      backdrop-filter: blur(6px);
      border: 2px dashed rgba(252, 211, 77, 0.9);
      user-select: none;
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .label-box.drag-over {
      transform: translateY(-1px);
      box-shadow: 0 0 18px rgba(34,197,94,0.35);
      border-color: rgba(34,197,94,0.85);
    }
    .label-box.matched {
      background: linear-gradient(135deg, #4ade80, #22c55e);
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>

<body class="h-full bg-gradient-to-br from-sky-100 via-blue-50 to-emerald-50 overflow-auto">
  <div id="app" class="w-full min-h-full p-4">

    <header class="text-center mb-4">
      <h1 id="game-title" class="text-2xl md:text-3xl font-bold text-blue-600 mb-2">ğŸš‚ å°ç£éµè·¯è»Šç«™é…å°éŠæˆ² ğŸšƒ</h1>
      <p id="instruction-text" class="text-gray-600 text-sm md:text-base">æŠŠå³é‚Šçš„è»Šç«™åç¨±æ‹–åˆ°å·¦é‚Šæ­£ç¢ºçš„ä½ç½®å§ï¼</p>
    </header>

    <div class="flex flex-col lg:flex-row gap-4 max-w-7xl mx-auto">

      <div class="lg:w-2/3 bg-white rounded-3xl shadow-xl p-4">
        <div class="flex items-center justify-center mb-3">
          <span class="text-lg font-bold text-slate-700">ğŸ—ºï¸ åŒ—è¿´ç·šéµè·¯åœ°åœ–</span>
        </div>

        <div class="relative w-full overflow-hidden rounded-3xl bg-slate-50">
          <!-- âœ… å˜—è©¦ç›´æ¥ç”¨ Google Photos åˆ†äº«é€£çµ -->
          <img
            id="rail-map"
            src=""
            class="w-full h-auto block select-none pointer-events-none"
            alt="rail map"
          />

          <div id="map-error"
               class="absolute inset-0 hidden items-center justify-center text-center p-6">
            <div class="bg-white/90 rounded-2xl p-4 shadow">
              <div class="text-lg font-bold text-rose-600 mb-1">åœ–ç‰‡è¼‰å…¥å¤±æ•—</div>
              <div class="text-sm text-slate-600 leading-relaxed">
                Google Photos åˆ†äº«é é€šå¸¸ä¸æ˜¯ã€Œç›´æ¥åœ–ç‰‡æª”ç¶²å€ã€ï¼Œ<br>
                æ‰€ä»¥ <code>&lt;img&gt;</code> å¸¸æœƒé¡¯ç¤ºä¸å‡ºä¾†ã€‚<br><br>
                è§£æ³•ï¼šæ”¹ç”¨ã€Œå¯ç›´é€£åœ–ç‰‡ã€çš„ç¶²å€ï¼Œæˆ–ç”¨ Apps Script ç•¶ä¸­ç¹¼æŠ“åœ–ã€‚
              </div>
            </div>
          </div>

          <svg id="links-layer"
               class="absolute inset-0 w-full h-full pointer-events-none"
               viewBox="0 0 100 100"
               preserveAspectRatio="none">
            <defs>
              <marker id="arrowhead" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
                <path d="M0,0 L6,3 L0,6 Z" fill="rgba(51,65,85,0.75)"></path>
              </marker>
            </defs>
          </svg>

          <div id="dots-container" class="absolute inset-0"></div>
          <div id="labels-container"
               class="absolute top-2 bottom-2 left-2 flex flex-col justify-between gap-2 w-[190px] pointer-events-auto">
          </div>
        </div>
      </div>

      <div class="lg:w-1/3 flex flex-col gap-4">
        <div class="bg-white rounded-3xl shadow-xl p-4">
          <div class="flex items-center justify-between mb-3">
            <span class="text-lg font-bold text-orange-600">ğŸ´ è»Šç«™å¡ç‰‡</span>
            <button id="reset-btn"
              class="bg-gradient-to-r from-pink-400 to-rose-400 text-white px-4 py-2 rounded-full text-sm font-bold hover:from-pink-500 hover:to-rose-500 transition-all shadow-md hover:shadow-lg">
              ğŸ”„ é‡æ–°é–‹å§‹
            </button>
          </div>

          <div id="cards-container" class="flex flex-wrap gap-2 justify-center min-h-[120px]"></div>

          <div id="progress-bar" class="mt-3 bg-gray-200 rounded-full h-3 overflow-hidden">
            <div id="progress-fill"
              class="bg-gradient-to-r from-green-400 to-emerald-500 h-full transition-all duration-500"
              style="width: 0%"></div>
          </div>
          <p id="progress-text" class="text-center text-sm text-gray-500 mt-1">é…å°é€²åº¦ï¼š0 / 11</p>
        </div>

        <div id="info-panel" class="info-panel rounded-3xl shadow-xl p-4 min-h-[280px] flex flex-col items-center justify-center">
          <div id="info-content" class="text-center">
            <div class="text-6xl mb-3">ğŸš‰</div>
            <p class="text-lg text-amber-800 font-medium">
              é»æ“Šå·²é…å°çš„è»Šç«™<br>ä¾†çœ‹çœ‹ç•¶åœ°çš„ç‰¹è‰²å§ï¼
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const GOOGLE_PHOTOS_SHARE_URL =
      "https://photos.google.com/album/AF1QipMEud_BpjEYmyQu2RNnxObrgFHnd7e1BDp7PK0/photo/AF1QipOgErg3CmrlWah5QJOwviR6GZi-YDaz5t9Jzqo";

    const defaultConfig = {
      game_title: 'ğŸš‚ å°ç£éµè·¯è»Šç«™é…å°éŠæˆ² ğŸšƒ',
      instruction_text: 'æŠŠå³é‚Šçš„è»Šç«™åç¨±æ‹–åˆ°å·¦é‚Šæ­£ç¢ºçš„ä½ç½®å§ï¼'
    };

    const stationsData = [
      { id:'songshan', name:'æ¾å±±', description:'æ¾å±±æ˜¯å°åŒ—é‡è¦çš„äº¤é€šæ¨ç´ï¼Œé€™è£¡æœ‰ç†±é¬§çš„é¥’æ²³å¤œå¸‚ï¼Œå¯ä»¥åƒåˆ°å„ç¨®ç¾å‘³çš„å°åƒå–”ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><rect x="10" y="40" width="80" height="50" rx="5" fill="#FF6B6B"/></svg>`},
      { id:'ruifang', name:'ç‘èŠ³', description:'ç‘èŠ³æ˜¯é€šå¾€ä¹ä»½å±±åŸçš„é–€æˆ¶ï¼Œé€™è£¡æ›¾ç¶“æ˜¯æ¡é‡‘ç¤¦çš„åœ°æ–¹ï¼Œæœ‰è‘—è±å¯Œçš„ç¤¦æ¥­æ–‡åŒ–ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><polygon points="50,10 20,50 80,50" fill="#8B7355"/></svg>`},
      { id:'houtong', name:'çŒ´ç¡', description:'çŒ´ç¡æ˜¯è‘—åçš„è²“æ‘ï¼Œæœ‰å¥½å¤šå¯æ„›çš„è²“å’ªåœ¨è»Šç«™é™„è¿‘æ•£æ­¥ï¼Œæ˜¯è²“å’ªæ„›å¥½è€…çš„å¤©å ‚ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><circle cx="50" cy="50" r="25" fill="#FFA07A"/></svg>`},
      { id:'sandiaoling', name:'ä¸‰è²‚å¶º', description:'ä¸‰è²‚å¶ºæ˜¯ä¸€å€‹ç§˜å¢ƒè»Šç«™ï¼Œé™„è¿‘æœ‰ç¾éº—çš„ç€‘å¸ƒå’ŒåŸå§‹çš„è‡ªç„¶é¢¨å…‰ï¼Œæ˜¯æ¢éšªçš„å¥½åœ°æ–¹ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><path d="M10,80 L50,20 L90,80" stroke="#22c55e" stroke-width="6" fill="none"/></svg>`},
      { id:'mudan', name:'ç‰¡ä¸¹', description:'ç‰¡ä¸¹æ˜¯ä¸€å€‹å¯§éœç´”æ¨¸çš„é„‰æ‘å°ç«™ï¼Œå‘¨åœæœ‰ç¾éº—çš„ç”°åœ’é¢¨å…‰å’Œç››é–‹çš„èŠ±æœµï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><circle cx="50" cy="50" r="20" fill="#FF69B4"/></svg>`},
      { id:'shuangxi', name:'é›™æºª', description:'é›™æºªæœ‰å¤è€çš„æˆ¿å±‹å’Œæ¸…æ¾ˆçš„æºªæµï¼Œèµ°åœ¨è€è¡—ä¸Šå¯ä»¥æ„Ÿå—åˆ°æ¿ƒæ¿ƒçš„æ‡·èˆŠæ°£æ¯ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><rect x="20" y="35" width="60" height="40" fill="#8B4513"/></svg>`},
      { id:'gongliao', name:'è²¢å¯®', description:'è²¢å¯®é è¿‘æ±åŒ—è§’æµ·å²¸ï¼Œé€™è£¡æœ‰å±±æµ·æ™¯è‰²å’Œå¯§éœçš„èšè½æ°›åœï¼Œä¹Ÿå¾ˆé©åˆå®‰æ’è¼•æ—…è¡Œï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><rect x="0" y="60" width="100" height="40" fill="#7dd3fc"/></svg>`},
      { id:'fulong', name:'ç¦éš†', description:'ç¦éš†æœ‰ç¾éº—çš„é‡‘è‰²æ²™ç˜ï¼Œæ¯å¹´å¤å¤©é‚„æœƒèˆ‰è¾¦ç†±é¬§çš„æµ·æ´‹éŸ³æ¨‚ç¥­ï¼Œè¶…ç´šå¥½ç©ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><circle cx="70" cy="30" r="15" fill="#FFD700"/></svg>`},
      { id:'yilan', name:'å®œè˜­', description:'å®œè˜­æ˜¯ä¸€å€‹å……æ»¿ç«¥è¶£çš„åŸå¸‚ï¼Œæœ‰å¾ˆå¤šè¦ªå­æ™¯é»å’Œæœ‰è¶£çš„åšç‰©é¤¨ï¼Œé‚„æœ‰ç¾å‘³çš„å°åƒï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><rect x="20" y="25" width="60" height="50" fill="#4ECDC4"/></svg>`},
      { id:'suao', name:'è˜‡æ¾³', description:'è˜‡æ¾³æ˜¯ä¸€å€‹æ¼æ¸¯å°é®ï¼Œæœ‰æ–°é®®çš„æµ·é®®å’Œç‰¹åˆ¥çš„å†·æ³‰ï¼Œæ³¡å†·æ³‰æ¶ˆæš‘æœ€æ£’äº†ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><rect x="0" y="55" width="100" height="45" fill="#4682B4"/></svg>`},
      { id:'hualien', name:'èŠ±è“®', description:'èŠ±è“®æœ‰å£¯éº—çš„å¤ªé­¯é–£å³½è°·å’Œç¾éº—çš„æµ·å²¸ç·šï¼Œæ˜¯å°ç£æœ€ç¾çš„åœ°æ–¹ä¹‹ä¸€ï¼', svg:`<svg viewBox="0 0 100 100" class="w-full h-full"><polygon points="0,80 25,25 50,80" fill="#696969"/></svg>`},
    ];

    const stationPositions = {
      ruifang:     { left: 83.8624, top: 17.4038 },
      houtong:     { left: 85.3469, top: 18.7050 },
      gongliao:    { left: 85.3687, top: 20.7569 },
      sandiaoling: { left: 87.3841, top: 21.1630 },
      songshan:    { left: 71.4139, top: 21.7501 },
      mudan:       { left: 88.2645, top: 23.0472 },
      shuangxi:    { left: 91.0699, top: 23.2701 },
      fulong:      { left: 93.2582, top: 24.1212 },
      yilan:       { left: 81.9738, top: 40.8883 },
      suao:        { left: 88.0173, top: 51.8708 },
      hualien:     { left: 73.1525, top: 91.5738 },
    };

    let matchedStations = new Set();
    let currentCards = [];
    let draggedCard = null;

    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }

    function getSortedStationsNorthToSouth() {
      return stationsData
        .filter(s => stationPositions[s.id])
        .slice()
        .sort((a, b) => stationPositions[a.id].top - stationPositions[b.id].top);
    }

    function computeLaneX(idx, count) {
      const minX = 38;
      const maxX = 66;
      if (count <= 1) return (minX + maxX) / 2;
      return minX + (idx * (maxX - minX) / (count - 1));
    }

    function renderMapAndLabels() {
      const dotsLayer = document.getElementById('dots-container');
      const labelsLayer = document.getElementById('labels-container');
      const svg = document.getElementById('links-layer');

      dotsLayer.innerHTML = '';
      labelsLayer.innerHTML = '';

      const defs = svg.querySelector('defs');
      svg.innerHTML = '';
      if (defs) svg.appendChild(defs);

      const sortedStations = getSortedStationsNorthToSouth();
      const n = sortedStations.length;

      const labelAnchorX = 24;
      const topY = 8;
      const bottomY = 92;

      sortedStations.forEach((station, idx) => {
        const isMatched = matchedStations.has(station.id);
        const pos = stationPositions[station.id];

        const dot = document.createElement('div');
        dot.className = 'absolute dot-target';
        dot.dataset.stationId = station.id;
        dot.style.left = pos.left + '%';
        dot.style.top = pos.top + '%';

        if (isMatched) {
          dot.classList.add('matched');
          dot.addEventListener('click', () => showStationInfo(station));
        }
        dotsLayer.appendChild(dot);

        const labelY = (n === 1) ? 50 : (topY + (idx * (bottomY - topY) / (n - 1)));

        const label = document.createElement('div');
        label.className = 'label-box';
        label.dataset.stationId = station.id;

        label.innerHTML = `
          <div class="flex items-center gap-2">
            <span class="w-5 text-right">${idx + 1}</span>
            <span class="flex-1">${isMatched ? station.name : 'ï¼Ÿï¼Ÿï¼Ÿ'}</span>
            ${isMatched ? '<span>âœ“</span>' : ''}
          </div>
        `;

        if (isMatched) {
          label.classList.add('matched');
          label.addEventListener('click', () => showStationInfo(station));
        } else {
          label.addEventListener('dragover', handleDragOverLabel);
          label.addEventListener('dragleave', handleDragLeaveLabel);
          label.addEventListener('drop', handleDropOnLabel);
        }
        labelsLayer.appendChild(label);

        const x1 = labelAnchorX;
        const y1 = labelY;
        const x2 = pos.left;
        const y2 = pos.top;
        const laneX = computeLaneX(idx, n);

        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        const d = `M ${x1} ${y1} L ${laneX} ${y1} L ${laneX} ${y2} L ${x2} ${y2}`;
        path.setAttribute('d', d);
        path.setAttribute('fill', 'none');
        path.setAttribute('stroke', isMatched ? 'rgba(16,185,129,0.85)' : 'rgba(51,65,85,0.55)');
        path.setAttribute('stroke-width', '0.8');
        path.setAttribute('marker-end', 'url(#arrowhead)');
        svg.appendChild(path);
      });
    }

    function renderCards() {
      const container = document.getElementById('cards-container');
      container.innerHTML = '';
      currentCards.forEach(station => {
        if (!matchedStations.has(station.id)) {
          const card = document.createElement('div');
          card.className = 'station-card bg-gradient-to-br from-blue-400 to-indigo-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-md hover:shadow-lg hover:scale-105';
          card.draggable = true;
          card.dataset.stationId = station.id;
          card.textContent = station.name;

          card.addEventListener('dragstart', handleDragStart);
          card.addEventListener('dragend', handleDragEnd);

          card.addEventListener('touchstart', handleTouchStart, { passive: false });
          card.addEventListener('touchmove', handleTouchMove, { passive: false });
          card.addEventListener('touchend', handleTouchEnd);

          container.appendChild(card);
        }
      });
      if (currentCards.every(s => matchedStations.has(s.id))) {
        container.innerHTML = '<p class="text-green-600 font-bold text-lg">ğŸ‰ å¤ªæ£’äº†ï¼å…¨éƒ¨é…å°å®Œæˆï¼</p>';
      }
    }

    function handleDragStart(e) {
      draggedCard = e.target;
      e.target.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/plain', e.target.dataset.stationId);
    }
    function handleDragEnd(e) {
      e.target.classList.remove('dragging');
      draggedCard = null;
      document.querySelectorAll('.label-box').forEach(l => l.classList.remove('drag-over'));
    }
    function handleDragOverLabel(e) { e.preventDefault(); e.currentTarget.classList.add('drag-over'); }
    function handleDragLeaveLabel(e) { e.currentTarget.classList.remove('drag-over'); }
    function handleDropOnLabel(e) {
      e.preventDefault();
      e.currentTarget.classList.remove('drag-over');
      const cardId = e.dataTransfer.getData('text/plain');
      const labelId = e.currentTarget.dataset.stationId;
      if (cardId === labelId) matchStation(cardId);
    }

    let clonedCard = null;
    function handleTouchStart(e) {
      e.preventDefault();
      const touch = e.touches[0];
      draggedCard = e.target;

      clonedCard = e.target.cloneNode(true);
      clonedCard.style.position = 'fixed';
      clonedCard.style.zIndex = '1000';
      clonedCard.style.pointerEvents = 'none';
      clonedCard.style.opacity = '0.85';
      clonedCard.style.transform = 'scale(1.1)';
      document.body.appendChild(clonedCard);
      updateClonedCardPosition(touch.clientX, touch.clientY);
    }
    function handleTouchMove(e) {
      e.preventDefault();
      if (!clonedCard) return;
      const touch = e.touches[0];
      updateClonedCardPosition(touch.clientX, touch.clientY);

      const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
      const label = elemBelow?.closest('.label-box');

      document.querySelectorAll('.label-box').forEach(l => l.classList.remove('drag-over'));
      if (label && !label.classList.contains('matched')) label.classList.add('drag-over');
    }
    function handleTouchEnd(e) {
      if (!clonedCard || !draggedCard) return;
      const touch = e.changedTouches[0];
      const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
      const label = elemBelow?.closest('.label-box');

      if (label && label.dataset.stationId === draggedCard.dataset.stationId) {
        matchStation(draggedCard.dataset.stationId);
      }

      document.querySelectorAll('.label-box').forEach(l => l.classList.remove('drag-over'));
      clonedCard.remove();
      clonedCard = null;
      draggedCard = null;
    }
    function updateClonedCardPosition(x, y) {
      if (!clonedCard) return;
      clonedCard.style.left = (x - 40) + 'px';
      clonedCard.style.top = (y - 20) + 'px';
    }

    function matchStation(stationId) {
      matchedStations.add(stationId);
      renderMapAndLabels();
      renderCards();
      updateProgress();
      const station = stationsData.find(s => s.id === stationId);
      if (station) showStationInfo(station);
    }

    function showStationInfo(station) {
      const infoContent = document.getElementById('info-content');
      infoContent.innerHTML = `
        <div class="bounce-in">
          <h3 class="text-xl font-bold text-amber-800 mb-3">ğŸš‰ ${station.name}è»Šç«™</h3>
          <div class="w-32 h-32 mx-auto mb-3 float-animation">${station.svg}</div>
          <p class="text-amber-700 text-sm leading-relaxed px-2">${station.description}</p>
        </div>
      `;
    }

    function updateProgress() {
      const total = stationsData.length;
      const matched = matchedStations.size;
      const percentage = (matched / total) * 100;
      document.getElementById('progress-fill').style.width = percentage + '%';
      document.getElementById('progress-text').textContent = `é…å°é€²åº¦ï¼š${matched} / ${total}`;
    }

    function resetGame() {
      matchedStations = new Set();
      currentCards = shuffleArray(stationsData);
      renderMapAndLabels();
      renderCards();
      updateProgress();
      document.getElementById('info-content').innerHTML = `
        <div class="text-6xl mb-3">ğŸš‰</div>
        <p class="text-lg text-amber-800 font-medium">
          é»æ“Šå·²é…å°çš„è»Šç«™<br>ä¾†çœ‹çœ‹ç•¶åœ°çš„ç‰¹è‰²å§ï¼
        </p>
      `;
    }

    function onConfigChange(config) {
      document.getElementById('game-title').textContent = config.game_title || defaultConfig.game_title;
      document.getElementById('instruction-text').textContent = config.instruction_text || defaultConfig.instruction_text;
    }
    function mapToCapabilities() {
      return { recolorables: [], borderables: [], fontEditable: undefined, fontSizeable: undefined };
    }
    function mapToEditPanelValues(config) {
      return new Map([
        ['game_title', config.game_title || defaultConfig.game_title],
        ['instruction_text', config.instruction_text || defaultConfig.instruction_text]
      ]);
    }

    function initBackgroundTryGooglePhotos() {
      const img = document.getElementById('rail-map');
      const err = document.getElementById('map-error');

      // âœ… ç›´æ¥å˜—è©¦
      img.src = GOOGLE_PHOTOS_SHARE_URL;

      img.onload = () => {
        err.classList.add('hidden');
        err.classList.remove('flex');
      };

      img.onerror = () => {
        err.classList.remove('hidden');
        err.classList.add('flex');
      };
    }

    document.getElementById('reset-btn').addEventListener('click', resetGame);

    if (window.elementSdk) {
      window.elementSdk.init({ defaultConfig, onConfigChange, mapToCapabilities, mapToEditPanelValues });
    }

    initBackgroundTryGooglePhotos();
    resetGame();
  </script>
</body>
</html>
